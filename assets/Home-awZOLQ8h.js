import{d as e,r as s,c as t,f as l,g as a,n as o,t as r,e as i,F as n,p as d,q as c,h as u}from"./vendor-Bz8EPWj3.js";const g={class:"space-y-4"},v={class:"flex flex-col items-center space-y-4"},x={class:"text-lg font-medium text-gray-900"},p=e({__name:"FileUpload",props:{isLoading:{type:Boolean}},emits:["fileSelected"],setup(e,{emit:n}){const d=n,c=s(),u=s(!1),p=()=>{c.value&&c.value.click()},m=e=>{var s;const t=null==(s=e.target.files)?void 0:s[0];t&&d("fileSelected",t)},h=e=>{var s;e.preventDefault(),u.value=!1;const t=null==(s=e.dataTransfer)?void 0:s.files[0];t&&d("fileSelected",t)},y=e=>{e.preventDefault(),u.value=!0},f=e=>{e.preventDefault(),u.value=!1};return(s,n)=>(i(),t("div",g,[l("div",{class:o(["border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-400 transition-colors cursor-pointer",{"border-blue-500 bg-blue-50":u.value}]),onDrop:h,onDragover:y,onDragleave:f,onClick:p},[l("input",{ref_key:"fileInput",ref:c,type:"file",class:"hidden",accept:".h5,.pb,.pkl,.pt,.pth,.bin,.ckpt,.zip",onChange:m},null,544),l("div",v,[n[1]||(n[1]=l("div",{class:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center"},[l("svg",{class:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})])],-1)),l("div",null,[l("p",x,r(e.isLoading?"处理中...":"点击上传或拖拽文件到此处"),1),n[0]||(n[0]=l("p",{class:"text-sm text-gray-500 mt-1"}," 支持 .h5, .pb, .pkl, .pt, .pth, .bin, .ckpt, .zip 格式 ",-1))]),n[2]||(n[2]=a('<div class="flex items-center space-x-4 text-xs text-gray-400"><div class="flex items-center space-x-1"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg><span>安全加密传输</span></div><div class="flex items-center space-x-1"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg><span>本地扫描处理</span></div></div>',1))])],34),n[3]||(n[3]=a('<div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"><div class="flex items-center space-x-2 text-gray-600"><div class="w-2 h-2 bg-blue-500 rounded-full"></div><span>TensorFlow</span></div><div class="flex items-center space-x-2 text-gray-600"><div class="w-2 h-2 bg-green-500 rounded-full"></div><span>PyTorch</span></div><div class="flex items-center space-x-2 text-gray-600"><div class="w-2 h-2 bg-purple-500 rounded-full"></div><span>Pickle</span></div><div class="flex items-center space-x-2 text-gray-600"><div class="w-2 h-2 bg-orange-500 rounded-full"></div><span>其他格式</span></div></div>',1))]))}}),m={class:"space-y-4"},h={key:0},y={class:"text-xs text-gray-500 mb-2"},f={class:"space-y-3"},b={class:"flex items-start justify-between"},w={class:"flex-1"},k={class:"flex items-center space-x-2 mb-2"},I={class:"text-base font-semibold text-gray-900"},M={class:"text-gray-600 text-sm mb-2"},C={class:"grid grid-cols-2 gap-2 mb-2"},B={class:"flex items-center space-x-2 text-xs text-gray-600"},S={key:0,class:"font-mono bg-gray-100 px-1 rounded"},T={key:1,class:"font-mono bg-gray-100 px-1 rounded text-gray-400"},j={class:"flex items-center space-x-2 text-xs text-gray-600"},F={key:0,class:"text-red-600 font-medium"},z={key:1,class:"text-red-600 font-medium text-gray-400"},A={key:0,class:"flex items-center space-x-2 text-xs text-gray-500"},H={class:"ml-4"},L=["onClick"],D={key:0,class:"mt-4 pt-4 border-t border-gray-200"},P={class:"bg-gray-50 rounded-lg p-4"},U={class:"space-y-2 text-sm text-gray-600"},E={class:"flex items-center space-x-2"},G={class:"flex items-center space-x-2"},_={class:"flex items-center space-x-2"},O={key:1,class:"text-center py-8"},R={class:"flex justify-end space-x-3 pt-6 border-t border-gray-200"},W=e({__name:"ScanResults",props:{results:{}},setup(e){const u=s(new Set),g=e=>({CRITICAL:"bg-red-100 text-red-800",HIGH:"bg-orange-100 text-orange-800",MEDIUM:"bg-yellow-100 text-yellow-800",LOW:"bg-blue-100 text-blue-800"}[e]||"bg-gray-100 text-gray-800"),v=e=>({CRITICAL:"严重",HIGH:"高风险",MEDIUM:"中等",LOW:"轻微"}[e]||"未知"),x=e=>({CRITICAL:"严重安全风险，可能导致系统被完全控制",HIGH:"高风险安全问题，可能导致数据泄露或系统损坏",MEDIUM:"中等安全风险，建议修复以提升安全性",LOW:"轻微安全问题，不影响核心功能但建议优化"}[e]||"未知风险等级"),p=e=>({CRITICAL:"立即停止使用该模型，联系安全团队进行详细分析",HIGH:"谨慎使用，建议在隔离环境中测试并寻找替代方案",MEDIUM:"建议修复相关问题后再部署到生产环境",LOW:"可在生产环境使用，建议在下次更新时修复"}[e]||"请联系安全团队获取建议"),W=e=>{console.log(`导出 ${e} 格式报告`)};return(s,N)=>(i(),t("div",m,[e.results.issues.length>0?(i(),t("div",h,[l("div",y,"DEBUG: Found "+r(e.results.issues.length)+" issues",1),l("div",f,[(i(!0),t(n,null,d(e.results.issues,(s,a)=>{return i(),t("div",{key:a,class:o(["border rounded-lg p-4 transition-all hover:shadow-md",(n=s.severity,{CRITICAL:"border-red-200 bg-red-50",HIGH:"border-orange-200 bg-orange-50",MEDIUM:"border-yellow-200 bg-yellow-50",LOW:"border-blue-200 bg-blue-50"}[n]||"border-gray-200")])},[l("div",b,[l("div",w,[l("div",k,[l("span",{class:o(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",g(s.severity)])},r(v(s.severity)),3),l("h4",I,r(s.title),1)]),l("p",M,r(s.description),1),l("div",C,[l("div",B,[N[2]||(N[2]=l("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),N[3]||(N[3]=l("span",{class:"font-medium"},"算子:",-1)),s.op?(i(),t("span",S,r(s.op),1)):(i(),t("span",T,"N/A"))]),l("div",j,[N[4]||(N[4]=l("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})],-1)),N[5]||(N[5]=l("span",{class:"font-medium"},"能力:",-1)),s.ability?(i(),t("span",F,r(s.ability),1)):(i(),t("span",z,"N/A"))])]),s.location&&"Unknown"!==s.location?(i(),t("div",A,[N[6]||(N[6]=l("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),l("span",null,"文件: "+r(s.location),1)])):c("",!0)]),l("div",H,[l("button",{onClick:e=>(e=>{u.value.has(e)?u.value.delete(e):u.value.add(e)})(a),class:"text-gray-400 hover:text-gray-600 transition-colors"},[(i(),t("svg",{class:o(["w-5 h-5 transform transition-transform",{"rotate-180":u.value.has(a)}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...N[7]||(N[7]=[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))],8,L)])]),u.value.has(a)?(i(),t("div",D,[l("div",P,[N[11]||(N[11]=l("h5",{class:"text-sm font-medium text-gray-900 mb-2"},"详细信息",-1)),l("div",U,[l("div",E,[N[8]||(N[8]=l("span",{class:"font-medium"},"扫描引擎:",-1)),l("span",null,r(e.results.scanner),1)]),l("div",G,[N[9]||(N[9]=l("span",{class:"font-medium"},"风险等级:",-1)),l("span",null,r(x(s.severity)),1)]),l("div",_,[N[10]||(N[10]=l("span",{class:"font-medium"},"建议操作:",-1)),l("span",null,r(p(s.severity)),1)])])])])):c("",!0)],2);var n}),128))])])):(i(),t("div",O,[...N[12]||(N[12]=[a('<div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"><svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><h3 class="text-lg font-medium text-gray-900 mb-1">恭喜！未发现安全问题</h3><p class="text-gray-600">该模型文件通过了安全检查，未检测到明显的安全威胁</p>',3)])])),l("div",R,[l("button",{onClick:N[0]||(N[0]=e=>W("json")),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"}," 导出 JSON "),l("button",{onClick:N[1]||(N[1]=e=>W("pdf")),class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors"}," 导出 PDF 报告 ")])]))}}),N={class:"min-h-screen py-12 px-4 sm:px-6 lg:px-8"},K={class:"max-w-4xl mx-auto"},V={class:"bg-white rounded-xl shadow-lg p-8 mb-8"},q={key:0,class:"bg-white rounded-xl shadow-lg p-6 mb-8"},J={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},$={class:"font-medium text-gray-900"},Q={class:"font-medium text-gray-900"},X={class:"font-medium text-gray-900"},Y={key:1,class:"bg-white rounded-xl shadow-lg p-8 mb-8"},Z={class:"text-center"},ee={class:"text-gray-600"},se={key:2,class:"space-y-6"},te={class:"bg-white rounded-xl shadow-lg p-6"},le={class:"grid grid-cols-2 md:grid-cols-5 gap-4"},ae={class:"text-center p-4 bg-blue-50 rounded-lg"},oe={class:"text-2xl font-bold text-blue-600"},re={class:"text-center p-4 bg-red-600 rounded-lg"},ie={class:"text-2xl font-bold text-white"},ne={class:"text-center p-4 bg-orange-500 rounded-lg"},de={class:"text-2xl font-bold text-white"},ce={class:"text-center p-4 bg-yellow-50 rounded-lg"},ue={class:"text-2xl font-bold text-yellow-600"},ge={class:"text-center p-4 bg-green-50 rounded-lg"},ve={class:"text-2xl font-bold text-green-600"},xe={class:"bg-white rounded-xl shadow-lg p-6"},pe=e({__name:"Home",setup(e){const o=s(null),n=s(!1),d=s(""),g=s(null),v=s(""),x=s(!1),m=async e=>{if(x.value)console.log("Already processing file, ignoring duplicate call");else{console.log("handleFileSelected called with file:",e.name),x.value=!0,n.value=!0;try{const s=await(async e=>{const s=await e.arrayBuffer(),t=await crypto.subtle.digest("SHA-256",s);return Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")})(e);console.log("File hash calculated:",s.substring(0,8)+"..."),console.log("Last file hash:",v.value?v.value.substring(0,8)+"...":"none");const t=!o.value||v.value!==s;console.log("Is different file:",t),o.value=e,v.value=s,t?(console.log("Clearing previous scan results"),g.value=null):console.log("Keeping existing scan results");const l=ScannerService.getInstance(),a=await l.scanModel({file:e,fileName:e.name,fileSize:e.size},e=>{d.value=e});console.log("Setting new scan results:",{totalIssues:a.totalIssues,criticalIssues:a.criticalIssues,highIssues:a.highIssues,mediumIssues:a.mediumIssues,lowIssues:a.lowIssues,issuesCount:a.issues.length,firstIssue:a.issues[0]}),g.value={totalIssues:a.totalIssues,criticalIssues:a.criticalIssues,highIssues:a.highIssues,mediumIssues:a.mediumIssues,lowIssues:a.lowIssues,issues:a.issues.map(e=>({severity:e.severity,title:e.title,description:e.description,location:e.location,op:e.op,ability:e.ability})),scanner:a.scanner},console.log("Scan results set successfully")}catch(s){console.error("扫描失败:",s),d.value="扫描失败："+(s instanceof Error?s.message:"未知错误"),(s instanceof TypeError||s instanceof Error&&(s.message.includes("Failed to fetch")||s.message.includes("请求超时")))&&(d.value="连接后端服务失败，请稍后重试"),setTimeout(()=>{n.value=!1,d.value=""},3e3)}finally{n.value=!1,x.value=!1}}},h=e=>{if(0===e)return"0 Bytes";const s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]};return(e,s)=>{return i(),t("div",N,[l("div",K,[s[13]||(s[13]=l("div",{class:"text-center mb-12"},[l("h2",{class:"text-4xl font-bold text-gray-900 mb-4"}," AI模型安全检查 "),l("p",{class:"text-xl text-gray-600 max-w-2xl mx-auto"}," 上传您的AI模型文件，我们将自动检测潜在的安全风险和恶意代码 ")],-1)),l("div",V,[u(p,{onFileSelected:m,"is-loading":n.value},null,8,["is-loading"])]),o.value?(i(),t("div",q,[s[3]||(s[3]=l("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"文件信息",-1)),l("div",J,[l("div",null,[s[0]||(s[0]=l("span",{class:"text-sm text-gray-500"},"文件名",-1)),l("p",$,r(o.value.name),1)]),l("div",null,[s[1]||(s[1]=l("span",{class:"text-sm text-gray-500"},"文件大小",-1)),l("p",Q,r(h(o.value.size)),1)]),l("div",null,[s[2]||(s[2]=l("span",{class:"text-sm text-gray-500"},"文件类型",-1)),l("p",X,r((v=o.value.name,{h5:"TensorFlow HDF5",pb:"TensorFlow SavedModel",pkl:"Pickle",pt:"PyTorch",pth:"PyTorch",bin:"Binary",ckpt:"TensorFlow Checkpoint"}[(null==(x=v.split(".").pop())?void 0:x.toLowerCase())||""]||"Unknown")),1)])])])):c("",!0),n.value?(i(),t("div",Y,[l("div",Z,[s[4]||(s[4]=l("div",{class:"loading-spinner mx-auto mb-4"},null,-1)),s[5]||(s[5]=l("h3",{class:"text-lg font-semibold text-gray-900 mb-2"},"正在扫描模型文件...",-1)),l("p",ee,r(d.value),1)])])):c("",!0),g.value?(i(),t("div",se,[l("div",te,[s[11]||(s[11]=l("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"扫描结果概览",-1)),l("div",le,[l("div",ae,[l("div",oe,r(g.value.totalIssues),1),s[6]||(s[6]=l("div",{class:"text-sm text-gray-600"},"总问题数",-1))]),l("div",re,[l("div",ie,r(g.value.criticalIssues),1),s[7]||(s[7]=l("div",{class:"text-sm text-white"},"严重问题",-1))]),l("div",ne,[l("div",de,r(g.value.highIssues),1),s[8]||(s[8]=l("div",{class:"text-sm text-white"},"高风险问题",-1))]),l("div",ce,[l("div",ue,r(g.value.mediumIssues),1),s[9]||(s[9]=l("div",{class:"text-sm text-gray-600"},"中等问题",-1))]),l("div",ge,[l("div",ve,r(g.value.lowIssues),1),s[10]||(s[10]=l("div",{class:"text-sm text-gray-600"},"轻微问题",-1))])])]),l("div",xe,[s[12]||(s[12]=l("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"详细检测结果",-1)),u(W,{results:g.value},null,8,["results"])])])):c("",!0),s[14]||(s[14]=a('<div class="bg-white rounded-xl shadow-lg p-8 mt-12"><h3 class="text-lg font-semibold text-gray-900 mb-4">支持的模型格式</h3><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div><h4 class="font-medium text-gray-900 mb-2">TensorFlow 模型</h4><ul class="text-sm text-gray-600 space-y-1"><li>• .h5 - HDF5 格式</li><li>• .pb - Protocol Buffer 格式</li><li>• .zip - SavedModel 完整目录打包（推荐）</li></ul></div><div><h4 class="font-medium text-gray-900 mb-2">PyTorch 及其他格式</h4><ul class="text-sm text-gray-600 space-y-1"><li>• .pkl - Pickle 格式</li><li>• .pt/.pth - PyTorch 格式</li><li>• .bin - 二进制格式</li></ul></div></div></div>',1))])]);var v,x}}});export{pe as default};
