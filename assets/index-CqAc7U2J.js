const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Home-Cp2stbpV.js","assets/vendor-Bz8EPWj3.js","assets/History-Bbvb1aEj.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=(t,s,r)=>((t,s,r)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r)(t,"symbol"!=typeof s?s+"":s,r);import{d as s,r,o as n,a as o,b as a,c as i,e as l,f as c,g as u,h as d,w as m,i as p,n as h,t as f,j as w,k as y,l as g,m as v}from"./vendor-Bz8EPWj3.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const b={},x=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),n=(null==s?void 0:s.nonce)||(null==s?void 0:s.getAttribute("nonce"));r=e(t.map(e=>{if((e=function(e){return"/malmodelscan/"+e}(e))in b)return;b[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${s}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,n&&r.setAttribute("nonce",n),document.head.appendChild(r),t?new Promise((t,s)=>{r.addEventListener("load",t),r.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function n(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&n(e.reason);return e().catch(n)})},E={apiBaseUrl:"https://malmodelscan.onrender.com",appTitle:"MalModelScan - AI模型安全检查工具",appVersion:"1.0.0",appDescription:"专业的机器学习模型安全扫描工具",appAuthor:"MalModelScan Team",isDevelopment:"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname};class S extends Error{constructor(e,t,s){super(t),this.status=e,this.url=s,this.name="ApiError"}}class T extends Error{constructor(e,t){super(e),this.url=t,this.name="NetworkError"}}const k=new class{constructor(){t(this,"baseURL"),t(this,"timeout"),this.baseURL=E.apiBaseUrl,this.timeout=3e4}async request(e,t={}){const s=`${this.baseURL}${e}`,r=new AbortController,n=setTimeout(()=>r.abort(),this.timeout);try{const e=await fetch(s,{...t,signal:r.signal,headers:{"Content-Type":"application/json",...t.headers}});if(clearTimeout(n),!e.ok)throw new S(e.status,e.statusText,s);return await e.json()}catch(o){if(clearTimeout(n),"AbortError"===o.name)throw new S(408,"Request timeout",s);if(o instanceof TypeError)throw new T("无法连接到后端服务，请检查网络连接",s);throw o}}async healthCheck(){return this.request("/health")}async uploadModel(e){const t=new FormData;return t.append("file",e),this.request("/api/upload",{method:"POST",body:t,headers:{}})}async getScanStatus(e){return this.request(`/api/scan/status/${e}`)}async getScanResult(e){return this.request(`/api/scan/result/${e}`)}async getScanHistory(){return this.request("/api/scans/history")}async clearScanHistory(){return this.request("/api/scans/history",{method:"DELETE"})}async scanModel(e,t){try{null==t||t("正在上传模型文件...");const s=await this.uploadModel(e);null==t||t("开始安全扫描...");return await this.waitForScanComplete(s.scan_id,t)}catch(s){if(console.error("扫描失败:",s),s instanceof T)throw new Error("网络连接失败，请检查后端服务是否正常运行");if(s instanceof S)throw new Error(`扫描失败: ${s.message}`);throw s}}async waitForScanComplete(e,t){for(let r=0;r<60;r++)try{const s=await this.getScanStatus(e);switch(s.status){case"queued":null==t||t("扫描任务已排队，等待处理...");break;case"scanning":s.progress?null==t||t(`扫描中... ${s.progress}%`):null==t||t(s.message||"正在扫描模型文件...");break;case"completed":null==t||t("扫描完成，正在生成报告...");const r=await this.getScanResult(e);return this.formatScanResult(r);case"failed":throw new Error(s.message||"扫描失败");default:null==t||t("处理中...")}"completed"!==s.status&&"failed"!==s.status&&await new Promise(e=>setTimeout(e,5e3))}catch(s){if(s instanceof S&&404===s.status){null==t||t("正在初始化扫描任务..."),await new Promise(e=>setTimeout(e,5e3));continue}throw s}throw new Error("扫描超时，请稍后重试")}formatScanResult(e){var t;const s=e.issues.reduce((e,t)=>{const s=t.severity.toUpperCase();return e[s]=(e[s]||0)+1,e},{});return{totalIssues:e.total_issues,criticalIssues:s.CRITICAL||0,highIssues:s.HIGH||0,mediumIssues:s.MEDIUM||0,lowIssues:s.LOW||0,issues:e.issues.map(e=>({severity:e.severity.toUpperCase(),title:e.operator||e.op||"Unknown Operator",description:e.description,location:e.location,op:e.op,ability:e.ability})),scanner:"TensorDetect"===e.scanner_used?"TensorDetect":"ModelScan",scanTime:new Date(e.scan_time).getTime(),modelInfo:{framework:(null==(t=e.model_type)?void 0:t.includes("TensorFlow"))?"TensorFlow":"Other",format:e.model_type,size:"Unknown"}}}async getActiveScans(){return this.request("/api/scans/active")}},_={class:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100"},I={class:"bg-white shadow-sm border-b border-gray-200"},A={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},C={class:"flex justify-between items-center py-6"},M={class:"flex items-center space-x-6"},P={class:"flex items-center space-x-2"},L=s({__name:"App",setup(e){const t=r(!0);let s=null;const w=async()=>{try{const e=await(async()=>{try{return await k.healthCheck(),{isConnected:!0}}catch(e){let t="未知错误";return e instanceof T?t=e.message:e instanceof S&&(t=`API 服务错误 (${e.status}): ${e.message}`),{isConnected:!1,error:t}}})();t.value=e.isConnected}catch(e){console.warn("Health check failed:",e),t.value=!1}};return n(()=>{w(),s=window.setInterval(w,3e4)}),o(()=>{s&&(clearInterval(s),s=null)}),(e,s)=>{const r=a("router-link"),n=a("router-view");return l(),i("div",_,[c("header",I,[c("div",A,[c("div",C,[s[2]||(s[2]=u('<div class="flex items-center space-x-3"><div class="w-10 h-10 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-lg flex items-center justify-center"><svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg></div><h1 class="text-2xl font-bold text-gray-900">MalModelScan</h1></div>',1)),c("nav",M,[d(r,{to:"/",class:"text-gray-700 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium transition-colors","active-class":"bg-blue-100 text-blue-700"},{default:m(()=>[...s[0]||(s[0]=[p(" 模型扫描 ",-1)])]),_:1}),d(r,{to:"/history",class:"text-gray-700 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium transition-colors","active-class":"bg-blue-100 text-blue-700"},{default:m(()=>[...s[1]||(s[1]=[p(" 扫描历史 ",-1)])]),_:1}),c("div",P,[c("span",{class:h(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",t.value?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},[c("span",{class:h(["w-1.5 h-1.5 rounded-full mr-1.5",t.value?"bg-green-400":"bg-red-400"])},null,2),p(" "+f(t.value?"在线":"离线"),1)],2)])])])])]),c("main",null,[d(n)]),s[3]||(s[3]=c("footer",{class:"bg-white border-t border-gray-200 mt-auto"},[c("div",{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},[c("div",{class:"text-center text-gray-500 text-sm"},[c("p",null,"© 2024 MalModelScan. 专业的AI模型安全检查工具"),c("p",{class:"mt-2"},"支持 TensorFlow、PyTorch 等主流模型格式")])])],-1))])}}}),q=[{path:"/",component:()=>x(()=>import("./Home-Cp2stbpV.js"),__vite__mapDeps([0,1]))},{path:"/history",component:()=>x(()=>import("./History-Bbvb1aEj.js"),__vite__mapDeps([2,1]))}],j=w({history:y(),routes:q}),O=g(L);O.use(v()),O.use(j),O.mount("#app");export{k as a};
