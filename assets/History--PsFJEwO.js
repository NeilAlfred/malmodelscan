import{d as e,r as t,s,o as l,c as a,f as r,q as d,i as n,g as o,h as i,w as c,t as u,F as x,p as g,u as v,n as b,b as y,e as m}from"./vendor-Bz8EPWj3.js";const p={class:"min-h-screen py-12 px-4 sm:px-6 lg:px-8"},f={class:"max-w-6xl mx-auto"},h={class:"text-center mb-8"},w={class:"flex justify-center gap-4"},k=["disabled"],I={key:0,class:"flex items-center gap-2"},C={key:1},j=["disabled"],H={key:0,class:"text-center py-12"},M={key:1,class:"text-center py-12"},L={key:2,class:"space-y-6"},S={class:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-8"},T={class:"bg-white p-6 rounded-lg shadow border border-gray-200"},D={class:"text-2xl font-bold text-gray-900"},N={class:"bg-white p-6 rounded-lg shadow border border-gray-200"},U={class:"text-2xl font-bold text-red-600"},z={class:"bg-white p-6 rounded-lg shadow border border-gray-200"},_={class:"text-2xl font-bold text-orange-600"},A={class:"bg-white p-6 rounded-lg shadow border border-gray-200"},B={class:"text-2xl font-bold text-yellow-600"},E={class:"bg-white p-6 rounded-lg shadow border border-gray-200"},G={class:"text-2xl font-bold text-blue-600"},O={class:"bg-white shadow rounded-lg overflow-hidden"},R={class:"divide-y divide-gray-200"},V={class:"flex items-start justify-between"},W={class:"flex-1"},q={class:"flex items-center gap-3 mb-2"},F={class:"text-lg font-medium text-gray-900"},J={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-gray-600 mb-3"},K={class:"font-bold text-red-600"},P={key:0,class:"flex flex-wrap gap-2"},Q={key:0,class:"px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded-full"},X={key:1,class:"text-sm text-green-600"},Y={class:"ml-4 flex flex-col gap-2"},Z=["onClick"],$=["onClick","disabled"],ee={class:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto"},te={class:"p-6 border-b border-gray-200"},se={class:"flex justify-between items-start"},le={class:"text-xl font-bold text-gray-900 mb-2"},ae={class:"flex gap-2"},re={class:"p-6"},de={class:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6"},ne={class:"text-center p-4 bg-blue-50 rounded-lg"},oe={class:"text-2xl font-bold text-blue-600"},ie={class:"text-center p-4 bg-red-50 rounded-lg"},ce={class:"text-2xl font-bold text-red-600"},ue={class:"text-center p-4 bg-orange-50 rounded-lg"},xe={class:"text-2xl font-bold text-orange-600"},ge={class:"text-center p-4 bg-yellow-50 rounded-lg"},ve={class:"text-2xl font-bold text-yellow-600"},be={class:"text-center p-4 bg-green-50 rounded-lg"},ye={class:"text-2xl font-bold text-green-600"},me={key:0},pe={class:"space-y-4"},fe={class:"flex justify-between items-start mb-2"},he={class:"text-gray-600 mb-2"},we={key:0,class:"text-sm text-gray-500"},ke={key:1,class:"text-sm text-blue-600 mt-2"},Ie={key:1,class:"text-center py-8 text-green-600"},Ce=e({__name:"History",setup(e){const Ce=t([]),je=t(!1),He=t(null),Me=t(!1),Le=s(()=>Ce.value.reduce((e,t)=>e+t.criticalIssues,0)),Se=s(()=>Ce.value.reduce((e,t)=>e+(t.highIssues||0),0)),Te=s(()=>Ce.value.reduce((e,t)=>e+t.mediumIssues,0)),De=s(()=>Ce.value.reduce((e,t)=>e+t.lowIssues,0)),Ne=async()=>{je.value=!0;try{const e=ScannerService.getInstance(),t=await e.getHistory();Ce.value=t.sort((e,t)=>t.scanTime-e.scanTime)}catch(e){console.error("获取扫描历史失败:",e)}finally{je.value=!1}},Ue=async()=>{if(confirm("确定要清除所有扫描历史记录吗？此操作不可撤销。"))try{const e=ScannerService.getInstance();await e.clearScanHistory(),await Ne()}catch(e){console.error("清除历史记录失败:",e),alert("清除历史记录失败，请稍后重试")}},ze=e=>"TensorDetect"===e?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800",_e=e=>0===e?"安全":e>5?"高风险":e>2?"中风险":"低风险",Ae=e=>0===e.totalIssues?"bg-green-100 text-green-800":e.criticalIssues>0?"bg-red-100 text-red-800":e.highIssues&&e.highIssues>0?"bg-orange-100 text-orange-800":e.mediumIssues>0?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800",Be=e=>0===e.totalIssues?"安全":e.criticalIssues>0?"严重风险":e.highIssues&&e.highIssues>0?"高风险":e.mediumIssues>0?"中风险":"低风险",Ee=e=>{switch(e){case"CRITICAL":return"bg-red-100 text-red-800";case"HIGH":return"bg-orange-100 text-orange-800";case"MEDIUM":return"bg-yellow-100 text-yellow-800";case"LOW":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},Ge=e=>{switch(e){case"CRITICAL":return"text-red-800";case"HIGH":return"text-orange-800";case"MEDIUM":return"text-yellow-800";case"LOW":return"text-blue-800";default:return"text-gray-800"}};return l(()=>{Ne()}),(e,t)=>{const s=y("router-link");return m(),a("div",p,[r("div",f,[r("div",h,[t[3]||(t[3]=r("h2",{class:"text-3xl font-bold text-gray-900 mb-4"}," 扫描历史记录 ",-1)),t[4]||(t[4]=r("p",{class:"text-gray-600 mb-4"}," 查看所有模型扫描的历史记录和结果 ",-1)),r("div",w,[r("button",{onClick:Ne,disabled:je.value,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[je.value?(m(),a("span",I,[...t[2]||(t[2]=[r("div",{class:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1),n(" 刷新中... ",-1)])])):(m(),a("span",C,"刷新记录"))],8,k),r("button",{onClick:Ue,disabled:je.value||0===Ce.value.length,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," 清除历史 ",8,j)])]),je.value&&0===Ce.value.length?(m(),a("div",H,[...t[5]||(t[5]=[r("div",{class:"loading-spinner mx-auto mb-4"},null,-1),r("p",{class:"text-gray-600"},"正在加载扫描历史...",-1)])])):0===Ce.value.length?(m(),a("div",M,[t[7]||(t[7]=o('<div class="text-gray-400 mb-4"><svg class="mx-auto h-24 w-24" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div><h3 class="text-lg font-medium text-gray-900 mb-2">暂无扫描记录</h3><p class="text-gray-600 mb-4">开始扫描您的第一个模型文件</p>',3)),i(s,{to:"/",class:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},{default:c(()=>[...t[6]||(t[6]=[n(" 开始扫描 ",-1)])]),_:1})])):(m(),a("div",L,[r("div",S,[r("div",T,[r("div",D,u(Ce.value.length),1),t[8]||(t[8]=r("div",{class:"text-sm text-gray-600"},"总扫描次数",-1))]),r("div",N,[r("div",U,u(Le.value),1),t[9]||(t[9]=r("div",{class:"text-sm text-gray-600"},"严重问题",-1))]),r("div",z,[r("div",_,u(Se.value),1),t[10]||(t[10]=r("div",{class:"text-sm text-gray-600"},"高风险问题",-1))]),r("div",A,[r("div",B,u(Te.value),1),t[11]||(t[11]=r("div",{class:"text-sm text-gray-600"},"中等问题",-1))]),r("div",E,[r("div",G,u(De.value),1),t[12]||(t[12]=r("div",{class:"text-sm text-gray-600"},"轻微问题",-1))])]),r("div",O,[t[17]||(t[17]=r("div",{class:"px-6 py-4 border-b border-gray-200"},[r("h3",{class:"text-lg font-medium text-gray-900"},"扫描记录列表")],-1)),r("div",R,[(m(!0),a(x,null,g(Ce.value,(e,s)=>{var l,n,o;return m(),a("div",{key:e.scanId||s,class:"p-6 hover:bg-gray-50 transition-colors"},[r("div",V,[r("div",W,[r("div",q,[r("h4",F,u(e.fileName),1),r("span",{class:b([ze(e.scanner),"px-2 py-1 text-xs font-medium rounded-full"])},u(e.scanner),3),r("span",{class:b([Ae(e),"px-2 py-1 text-xs font-medium rounded-full"])},u(Be(e)),3)]),r("div",J,[r("div",null,[t[13]||(t[13]=r("span",{class:"font-medium"},"模型类型:",-1)),r("div",null,u((null==(l=e.modelInfo)?void 0:l.framework)||"Unknown"),1)]),r("div",null,[t[14]||(t[14]=r("span",{class:"font-medium"},"格式:",-1)),r("div",null,u((null==(n=e.modelInfo)?void 0:n.format)||"Unknown"),1)]),r("div",null,[t[15]||(t[15]=r("span",{class:"font-medium"},"扫描时间:",-1)),r("div",null,u((o=e.scanTime,new Date(o).toLocaleString("zh-CN"))),1)]),r("div",null,[t[16]||(t[16]=r("span",{class:"font-medium"},"发现问题:",-1)),r("div",K,u(e.totalIssues)+" 个",1)])]),e.issues.length>0?(m(),a("div",P,[(m(!0),a(x,null,g(e.issues.slice(0,3),e=>(m(),a("div",{key:e.title,class:b([Ee(e.severity),"px-2 py-1 text-xs rounded-full"])},u(e.title),3))),128)),e.issues.length>3?(m(),a("div",Q," +"+u(e.issues.length-3)+" 更多 ",1)):d("",!0)])):(m(),a("div",X," ✓ 未发现安全问题 "))]),r("div",Y,[r("button",{onClick:t=>(e=>{He.value=e})(e),class:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors"}," 查看详情 ",8,Z),r("button",{onClick:t=>(e=>{console.log("重新扫描:",e.fileName)})(e),disabled:Me.value,class:"px-3 py-1 text-sm bg-gray-600 text-white rounded hover:bg-gray-700 disabled:opacity-50 transition-colors"}," 重新扫描 ",8,$)])])])}),128))])])])),He.value?(m(),a("div",{key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:t[1]||(t[1]=v(e=>He.value=null,["self"]))},[r("div",ee,[r("div",te,[r("div",se,[r("div",null,[r("h3",le,u(He.value.fileName),1),r("div",ae,[r("span",{class:b([ze(He.value.scanner),"px-2 py-1 text-xs font-medium rounded-full"])},u(He.value.scanner),3),r("span",{class:b([(l=He.value.totalIssues,0===l?"bg-green-100 text-green-800":l>5?"bg-red-100 text-red-800":l>2?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"),"px-2 py-1 text-xs font-medium rounded-full"])},u(_e(He.value.totalIssues)),3)])]),r("button",{onClick:t[0]||(t[0]=e=>He.value=null),class:"text-gray-400 hover:text-gray-600"},[...t[18]||(t[18]=[r("svg",{class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),r("div",re,[r("div",de,[r("div",ne,[r("div",oe,u(He.value.totalIssues),1),t[19]||(t[19]=r("div",{class:"text-sm text-gray-600"},"总问题数",-1))]),r("div",ie,[r("div",ce,u(He.value.criticalIssues),1),t[20]||(t[20]=r("div",{class:"text-sm text-gray-600"},"严重问题",-1))]),r("div",ue,[r("div",xe,u(He.value.highIssues||0),1),t[21]||(t[21]=r("div",{class:"text-sm text-gray-600"},"高风险问题",-1))]),r("div",ge,[r("div",ve,u(He.value.mediumIssues),1),t[22]||(t[22]=r("div",{class:"text-sm text-gray-600"},"中等问题",-1))]),r("div",be,[r("div",ye,u(He.value.lowIssues),1),t[23]||(t[23]=r("div",{class:"text-sm text-gray-600"},"轻微问题",-1))])]),He.value.issues.length>0?(m(),a("div",me,[t[26]||(t[26]=r("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"问题详情",-1)),r("div",pe,[(m(!0),a(x,null,g(He.value.issues,e=>(m(),a("div",{key:e.title,class:"border border-gray-200 rounded-lg p-4"},[r("div",fe,[r("h5",{class:b([Ge(e.severity),"font-medium"])},u(e.title),3),r("span",{class:b([Ee(e.severity),"px-2 py-1 text-xs rounded-full"])},u(e.severity),3)]),r("p",he,u(e.description),1),e.location?(m(),a("div",we,[t[24]||(t[24]=r("strong",null,"位置:",-1)),n(" "+u(e.location),1)])):d("",!0),e.recommendation?(m(),a("div",ke,[t[25]||(t[25]=r("strong",null,"建议:",-1)),n(" "+u(e.recommendation),1)])):d("",!0)]))),128))])])):(m(),a("div",Ie," ✓ 未发现安全问题 "))])])])):d("",!0)])]);var l}}});export{Ce as default};
